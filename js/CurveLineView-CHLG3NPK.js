var e=Object.defineProperty,a=(a,n,r)=>((a,n,r)=>n in a?e(a,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[n]=r)(a,"symbol"!=typeof n?n+"":n,r);import{B as n}from"./base-BaImv3YL.js";import{d as r,z as o,A as t,g as i,o as s}from"./@vue-DISYwsDo.js";import{C as u,a as l,aO as m,t as d,L as v,u as c,V as h,S as f,b as w}from"./three-CyihR34C.js";const p={id:"webgl"},C=r({__name:"CurveLineView",setup(e){const r=new class extends n{constructor(){super(),a(this,"uniforms",{uStartColor:{value:new u(16777215)}})}load(){this.init("#webgl"),this.animate(),this.create()}create(){for(let e=0;e<100;e++){const a=new l(Math.sin(Math.PI*e*2/100)*Math.random()*200,50*Math.random()-50,Math.cos(Math.PI*e*2/100)*Math.random()*200),n=new l;n.addVectors(new l(0,0,0),a).multiplyScalar(.5),n.y=50*Math.random()+50,this.createCurveLineMesh(n,a)}this.gui.addColor(this.uniforms.uStartColor,"value").onChange((e=>{this.uniforms.uStartColor.value=e}))}createCurveLineMesh(e,a){var n;const r=new l(0,0,0),o=new m(r,e,a).getPoints(50),t=new d;for(let u=0;u<o.length-1;u++)t.curves.push(new v(o[u],o[u+1]));const i=new c(t,20,.5,8,!1),s={uTime:{value:1},uSpeed:{value:0},uFade:{value:new h(0,1)},uStartColor:{value:new u(16777215)},uColor:{value:new u(Math.random(),Math.random(),Math.random())}},p=new f({uniforms:s,transparent:!0,vertexShader:"\n        varying vec2 vUv;\n        void main(){\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:"\n        uniform float uTime;\n        uniform vec2 uFade;\n        uniform vec3 uStartColor;\n        uniform vec3 uColor;\n        uniform float uSpeed;\n        varying vec2 vUv;\n        void main(){\n            vec3 color = vec3(1.0,1.0,1.0);\n            vec3 color3 = mix(color, uColor, vUv.x);\n\n            float d = mod((vUv.x-uTime) * 1.0 ,1.0);\n\n             if(d >= 0.95){\n                color3 = vec3(uStartColor);\n            }\n\n            if(d > uFade.y){\n              discard;\n            }else {\n              //平滑透明度渐变\n              float alpha = smoothstep(uFade.x, uFade.y, d);\n              //透明度太小时不显示\n              if(alpha < 0.001){\n                discard;\n              }\n              gl_FragColor = vec4(color3,alpha);\n            }\n        }\n      "}),C=new w(i,p),M=.005*Math.random()+.005;C.onBeforeRender=()=>{p.uniforms.uTime.value+=M,p.uniforms.uTime.value>1&&(p.uniforms.uTime.value=0)},null==(n=this.scene)||n.add(C)}animate(){var e,a;null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),this.renderer.render(this.scene,this.camera),null==(a=this.stats)||a.end()}};return o((()=>{r.load()})),t((()=>{r.destroy()})),(e,a)=>(s(),i("div",p))}});export{C as default};

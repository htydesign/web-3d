var e=Object.defineProperty,n=(n,a,t)=>((n,a,t)=>a in n?e(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t)(n,"symbol"!=typeof a?a+"":a,t);import{B as a}from"./base-C-YIOOil.js";import{Z as t,C as r,V as o,$ as s,s as i,k as u,t as l,u as v,b as c}from"./three-BzDGKvaz.js";import{d as m,z as d,A as h,g as f,o as p}from"./@vue-B4sUqkWa.js";const w={id:"webgl"},g=m({__name:"CurveLineView",setup(e){const m=new class extends a{constructor(){super(),n(this,"uniforms",{uTime:{value:0},uSpeed:{value:0},uFade:{value:new t(0,1)},uStartColor:{value:new r(16777215)}})}load(){this.init("#webgl"),this.animate(),this.create()}create(){for(let e=0;e<500;e++){const n=new o(Math.sin(Math.PI*e*2/500)*Math.random()*200,0,Math.cos(Math.PI*e*2/500)*Math.random()*200),a=new o;a.addVectors(new o(0,0,0),n).multiplyScalar(.5),a.y=100,this.createCurveLineMesh(a,n)}this.gui.addColor(this.uniforms.uStartColor,"value").onChange((e=>{this.uniforms.uStartColor.value=e}))}createCurveLineMesh(e,n){var a;const t=new o(0,0,0),r=new s(t,e,n).getPoints(50),m=new i;for(let o=0;o<r.length-1;o++)m.curves.push(new u(r[o],r[o+1]));const d=new l(m,20,.5,8,!1),h={...this.uniforms,uSpeed:{value:Math.random()}},f=new v({uniforms:h,transparent:!0,vertexShader:"\n        varying vec2 vUv;\n        void main(){\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:"\n        uniform float uTime;\n        uniform vec2 uFade;\n        uniform vec3 uStartColor;\n        uniform float uSpeed;\n        varying vec2 vUv;\n        void main(){\n            vec3 color = vec3(1.0,1.0,1.0);\n            vec3 color2 = vec3(0.0,1.0,0.0);\n            vec3 color3 = mix(color, color2, vUv.x);\n\n\n\n\n\n            float d = mod((vUv.x-uTime) * 1.0 ,1.0);\n\n             if(d >= 0.95){\n                color3 = vec3(uStartColor);\n            }\n\n            if(d > uFade.y){\n              discard;\n            }else {\n              //平滑透明度渐变\n              float alpha = smoothstep(uFade.x, uFade.y, d);\n              //透明度太小时不显示\n              if(alpha < 0.001){\n                discard;\n              }\n              gl_FragColor = vec4(color3, alpha);\n            }\n        }\n      "}),p=new c(d,f);null==(a=this.scene)||a.add(p)}animate(){var e,n;null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),this.renderer.render(this.scene,this.camera),this.uniforms.uTime.value+=.01,this.uniforms.uTime.value>1&&(this.uniforms.uTime.value=0),null==(n=this.stats)||n.end()}};return d((()=>{m.load()})),h((()=>{m.gui.close(),m.gui.destroy()})),(e,n)=>(p(),f("div",w))}});export{g as default};

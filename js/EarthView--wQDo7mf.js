var e=Object.defineProperty,n=(n,o,a)=>((n,o,a)=>o in n?e(n,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[o]=a)(n,"symbol"!=typeof o?o+"":o,a);import{B as o}from"./base-DI5EaenM.js";import{$ as a,C as r,q as t,b as i,a0 as s,u as l,M as c,V as v,A as u,G as d,j as m,x as p,D as f,Q as g}from"./three-1nqLwmXn.js";import{d as w,z as h,A as y,g as C,o as b}from"./@vue-B4sUqkWa.js";const x={id:"webgl"},S=w({__name:"EarthView",setup(e){const w=new class extends o{constructor(){super(),n(this,"uniforms",{uTime:{value:0},uSpeed:{value:0},uFade:{value:new a(0,1)},uStartColor:{value:new r(16777215)}})}load(){this.init("#webgl"),this.animate(),this.create()}create(){var e,n;const o=new r(16777215*Math.random()),a=(new t).load("./texture/earth_specular_2048.jpg"),d=new i(new s(50,128,128),new l({uniforms:{uMap:{value:a},uColor:{value:o}},transparent:!0,wireframe:!0,vertexShader:"\n          varying vec2 vUv;\n          void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          }\n        ",fragmentShader:"\n            uniform sampler2D uMap;\n            uniform vec3 uColor;\n            varying vec2 vUv;\n            void main(){\n                vec3 color = texture2D(uMap, vUv).rgb;\n                if(color.r >= 0.59 && color.g >= 0.59 && color.b >= 0.59){\n                    discard;\n                }else {\n                    color = vec3(uColor);\n                }\n                gl_FragColor = vec4(color, 1.0);\n            }\n        "}));null==(e=this.scene)||e.add(d);const m=new i(new s(49,64,64),new c({color:0}));null==(n=this.scene)||n.add(m);const{position:p}=d.geometry.attributes;for(let r=0;r<20;r++){const e=Math.floor(p.count*Math.random()),n=new v(p.array[e],p.array[e+1],p.array[e+2]);this.createLightCube(n,o)}new i(new s(60,64,64),new l({blending:u,uniforms:{uColor:{value:o}},transparent:!0,fragmentShader:"\n            uniform vec3 uColor;\n            void main(){\n                gl_FragColor = vec4(1.0,1.0,1.0, 0.01);\n            }\n        "}))}createLightCube(e,n){var o;const a=new d;a.lookAt(new v(0,0,0)),a.position.copy(e);const r=(new v).subVectors(new v(0,0,0),e);r.normalize();const t=new g;t.setFromUnitVectors(new v(0,-1,0),r),a.quaternion.multiply(t);const s=new m(1,20,4),c=new l({transparent:!0,uniforms:{uColor:{value:n}},vertexShader:"\n      varying vec2 vUv;\n      void main() {\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n      }\n      ",fragmentShader:"\n        uniform vec3 uColor;\n        varying vec2 vUv;\n        void main(){\n            vec3 color1 = vec3(1.0);\n            vec3 color2 = mix(color1, uColor, vUv.y);\n            float alpha = smoothstep(1.0, 0.1, vUv.y);\n            gl_FragColor = vec4(color2, alpha);\n        }\n      "}),u=new i(s,c);u.position.set(0,10,0),a.add(u);const w=new p(10,10),h=new l({transparent:!0,side:f,uniforms:{uScale:{value:0},uColor:{value:n}},vertexShader:"\n        varying vec2 vUv;\n        void main(){\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:"\n        uniform float uScale;\n        uniform vec3 uColor;\n        varying vec2 vUv;\n        void main(){\n            float scale = uScale;\n            \n            vec3 color2 = vec3(1.0);\n\n            float dis = distance(vUv,vec2(0.5,0.5));\n\n            float opacity = smoothstep(0.4 * scale, 0.5 * scale, dis);\n\n            opacity *= step(dis,0.5 * scale);\n\n            opacity -= (scale - 0.8) * 5.0 * step(0.8,scale);\n\n            vec3 disColor = vec3(1.0) - color2;\n\n            vec3 color = color2 + disColor * scale;\n\n\n            gl_FragColor = vec4(color,opacity);\n        }\n      "}),y=new i(w,h);y.rotateX(-Math.PI/2),a.add(y),y.onBeforeRender=()=>{h.uniforms.uScale.value>=1&&(h.uniforms.uScale.value=0),h.uniforms.uScale.value+=.01},null==(o=this.scene)||o.add(a)}animate(){var e,n;null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),this.renderer.render(this.scene,this.camera),null==(n=this.stats)||n.end()}};return h((()=>{w.load()})),y((()=>{w.gui.close(),w.gui.destroy()})),(e,n)=>(b(),C("div",x))}});export{S as default};

var e=Object.defineProperty,n=(n,i,s)=>((n,i,s)=>i in n?e(n,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[i]=s)(n,"symbol"!=typeof i?i+"":i,s);import{B as i}from"./base-DHNtifFD.js";import{T as s,e as t,b as a,n as o,S as r,C as l,A as u,o as m,s as h}from"./three-BrSCsmw0.js";import{d as v,z as d,A as c,g as p,j as g,F as y,o as w}from"./@vue-DBDSYTU2.js";const f=v({__name:"EnergyShieldView",setup(e){const v=new class extends i{constructor(){super(),n(this,"shphere"),n(this,"mixer")}load(){this.init("#webgl"),this.animate(),this.energyShield(),this.light()}energyShield(){var e;const n=(new s).load("./texture/noise.jpg");n.wrapS=t,n.wrapT=t,this.shphere=new a(new o(50,50,50),new r({vertexShader:"\n        varying float vIntensity;\n        varying vec2 vUv;\n\n        void main() {\n            vec4 worldPosition = modelMatrix * vec4(position,1.0);\n            vec3 worldNormal = normalize(modelMatrix * vec4(normal,0.0)).xyz;\n            vec3 dirToCamera = normalize(cameraPosition - worldPosition.xyz);\n            vIntensity = 1.0 - dot(worldNormal,dirToCamera);\n            vIntensity = pow(vIntensity,3.0);\n\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\n\n            vUv = uv;\n        }\n      ",fragmentShader:"\n        varying float vIntensity;\n        varying vec2 vUv;\n        uniform sampler2D uNoise;\n        uniform vec3 uColor;\n        uniform float uTime;\n        void main() {\n          vec2 nuV = vUv;\n          nuV.y += uTime + 0.3;\n          nuV.x += uTime + 0.3;\n          vec4 noiseColor = texture2D(uNoise,nuV);\n          gl_FragColor = vec4(noiseColor.rgb * vIntensity * uColor,1.0);\n        }\n      ",uniforms:{uNoise:{value:n},uColor:{value:new l(16776960)},uTime:{value:0}},transparent:!0,blending:u})),this.shphere.position.set(0,0,0),this.scene.add(this.shphere);(new m).load("./models/gltf/Michelle.glb",(e=>{var n;const i=e.scene;this.mixer=new h(i),i.scale.set(50,50,50),i.position.set(0,-35,0);const s=this.mixer.clipAction(e.animations[0]);s.play();const t={"play/pause":()=>{s.paused?s.paused=!1:s.paused=!0}};this.gui.add(t,"play/pause"),null==(n=this.scene)||n.add(i)}));const i={color:16776960};null==(e=this.gui)||e.addColor(i,"color").onChange((()=>{this.shphere.material.uniforms.uColor.value=new l(i.color)}))}animate(){var e,n,i;null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),this.shphere&&(this.shphere.material.uniforms.uTime.value+=.005),this.mixer&&(null==(n=this.mixer)||n.update(this.clock.getDelta())),this.renderer.render(this.scene,this.camera),null==(i=this.stats)||i.end()}};return d((()=>{v.load()})),c((()=>{v.gui.close(),v.gui.destroy()})),(e,n)=>(w(),p(y,null,[n[0]||(n[0]=g("div",{id:"webgl"},null,-1)),n[1]||(n[1]=g("div",{class:"title-name"},"能量罩",-1))],64))}});export{f as default};

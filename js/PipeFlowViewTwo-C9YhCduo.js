var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{B as s}from"./base-C9hChz8a.js";import{a0 as a,ar as n,aW as i,a9 as r,b as o,M as l,V as h,x as c,r as p,aV as d,B as m,s as w,z as u,P as g,f as v,c as b}from"./three-BV2RzHAl.js";import{d as f,z as P,A as y,g as M,j as x,F as A,o as j}from"./@vue-B4sUqkWa.js";const S=f({__name:"PipeFlowViewTwo",setup(e){const f=new class extends s{constructor(){super(),t(this,"splineCamera",new a(60,window.innerWidth/window.innerHeight,.01,500)),t(this,"parent",new n),t(this,"cameraHelper"),t(this,"cameraSphereMesh")}load(){var e,t,s,a;this.init("#webgl"),this.animate(),null==(e=this.parent)||e.add(this.splineCamera),this.cameraHelper=new i(this.splineCamera),null==(t=this.scene)||t.add(this.cameraHelper);const n=new r(2,32,32);this.cameraSphereMesh=new o(n,new l({color:16720384})),null==(s=this.parent)||s.add(this.cameraSphereMesh),null==(a=this.scene)||a.add(this.parent),this.createMesh()}createPath(e){const t=e.map((e=>new h(e[0],e[1],e[2]))),s=new c;for(let a=0;a<t.length-1;a++)s.curves.push(new p(t[a],t[a+1]));return s}getTrajectoryPoint(e){const t=2*e,s=Math.sin(e);return new h(t,s,0)}createMesh(){var e,t;const s=new d([new h(-100,0,100),new h(-50,50,50),new h(0,0,0),new h(50,-50,50),new h(100,0,100)]),a=s.getPoints(50),n=(new m).setFromPoints(a),i=new m,{count:r,array:o}=n.attributes.position,l=new Float32Array(3*r);i.setAttribute("position",new w(l,3));for(let h=0;h<r-1;h++){const e=(0+h/r)%1,t=s.getPointAt(e);l[3*h+0]=t.x,l[3*h+1]=t.y,l[3*h+2]=t.z}i.attributes.position.needsUpdate=!0;const c=new u({vertexShader:"\n        void main(){\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n          gl_PointSize = 5.0;\n        }\n      ",fragmentShader:"\n        void main(){\n          gl_FragColor = vec4(1.0);\n        }\n      "}),p=new g(i,c);let f=0;p.onBeforeRender=()=>{var e;for(let t=0;t<r;t++){const a=(f+t/r)%1,n=s.getPointAt(a),i=s.getPointAt((f+(t+1)/r)%1);l[3*t+0]=n.x,l[3*t+1]=n.y,l[3*t+2]=n.z,0===t&&(null==(e=this.cameraSphereMesh)||e.position.copy(n),this.splineCamera.lookAt(i),this.splineCamera.position.copy(n))}f+=.001,i.attributes.position.needsUpdate=!0},null==(e=this.scene)||e.add(p);const P=new v(n,new b);null==(t=this.scene)||t.add(P)}animate(){var e,t;null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),this.cameraHelper&&this.cameraHelper.update(),this.renderer.render(this.scene,this.camera),null==(t=this.stats)||t.end()}};return P((()=>{f.load()})),y((()=>{f.gui.close(),f.gui.destroy()})),(e,t)=>(j(),M(A,null,[t[0]||(t[0]=x("div",{id:"webgl"},null,-1)),t[1]||(t[1]=x("div",{class:"title-name"},"粒子管道流动",-1))],64))}});export{S as default};

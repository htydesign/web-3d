var e=Object.defineProperty,t=(t,o,r)=>((t,o,r)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r)(t,"symbol"!=typeof o?o+"":o,r);import{B as o}from"./base-DRfanOAB.js";import{G as r,a4 as n,a2 as a,q as s,i as l,A as i,C as u,S as d}from"./three-nzgV1uvU.js";import{d as h,z as C,A as g,g as m,j as c,F as v,o as p}from"./@vue-B4sUqkWa.js";import{_ as w}from"./index-C-GkNdId.js";import"./pinia-C4SihLJg.js";import"./vue-router-CANWKAPm.js";const f=w(h({__name:"HeatMapView",setup(e){const h=new class extends o{constructor(){super(),t(this,"group",new r),t(this,"measureGroup",new r),t(this,"raycaster",new n),t(this,"pointer",new a),t(this,"startMeasure",!1),t(this,"arr",[]),t(this,"isMove",!1)}load(){var e;this.init("#webgl"),this.animate(),null==(e=this.scene)||e.add(this.group),this.scene.add(this.measureGroup),this.create()}create(){var e;const t=(new s).load("./texture/sprite.png"),o=new l({blending:i,transparent:!0,depthTest:!1}),r={uTexture:{value:t},uHightColor:{value:new u(16777215)},uLowColor:{value:new u(16777215)},uCenterColor:{value:new u(16777215)}},n={uHightColor:16777215,uLowColor:16777215,uCenterColor:16777215};this.gui.addColor(n,"uCenterColor").name("中心点").onChange((()=>{r.uCenterColor.value=new u(n.uCenterColor)})),this.gui.addColor(n,"uHightColor").name("高亮").onChange((()=>{r.uHightColor.value=new u(n.uHightColor)})),this.gui.addColor(n,"uLowColor").name("边缘").onChange((()=>{r.uLowColor.value=new u(n.uLowColor)})),o.onBeforeCompile=e=>{Object.assign(e.uniforms,r),e.vertexShader=`\n        varying vec2 vUv;\n        ${e.vertexShader}\n      `,e.vertexShader=e.vertexShader.replace("#include <fog_vertex>","\n        #include <fog_vertex>  \n        vUv = uv;    \n      "),e.fragmentShader=`\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform vec3 uHightColor;\n        uniform vec3 uLowColor;\n        uniform vec3 uCenterColor;\n        ${e.fragmentShader}\n      `,e.fragmentShader=e.fragmentShader.replace("#include <fog_fragment>","\n        #include <fog_fragment>\n\n        vec4 textColor = texture2D(uTexture, vUv);\n        vec3 newColor = textColor.rgb ;\n\n        if(textColor.a < 0.5){\n          newColor = uLowColor;\n        }else if(textColor.a > 0.5 && textColor.a < 0.75) {        \n          float t = smoothstep(0.5,0.75,textColor.a);\n          newColor = mix(uLowColor,uHightColor,t);\n        }else {\n          float t = smoothstep(0.75,1.0,textColor.a);\n          newColor = mix(uHightColor,uCenterColor,t);          \n        }        \n        gl_FragColor = vec4(newColor,textColor.a);      \n      ")};for(let a=0;a<100;a++){const t=new d(o);t.scale.set(20,20,20),t.position.set(100*Math.random()-50,0,100*Math.random()-50),null==(e=this.scene)||e.add(t)}}createSpriteMap(){const e=document.createElement("canvas"),t=e.getContext("2d");e.style.width="200px",e.style.height="200px",e.width=100,e.height=100;const o=t.createRadialGradient(50,50,0,50,50,50);return o.addColorStop(0,"rgba(255,255,255,1)"),o.addColorStop(1,"rgba(255,255,255,0)"),t.fillStyle=o,t.fillRect(0,0,100,100),e}animate(){var e,t;null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),this.renderer&&this.renderer.render(this.scene,this.camera),null==(t=this.stats)||t.end()}};return C((()=>{h.load()})),g((()=>{h.gui.close(),h.gui.destroy()})),(e,t)=>(p(),m(v,null,[t[0]||(t[0]=c("div",{id:"webgl"},null,-1)),t[1]||(t[1]=c("div",{class:"title-name"},"热力图",-1))],64))}}),[["__scopeId","data-v-56653214"]]);export{f as default};

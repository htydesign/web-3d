var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{W as s}from"./webgpuBasic-RWdrGxvh.js";import{T as a,be as n,aV as r,bf as i,bg as l,bh as o,bi as d,bj as c,bk as h,bl as u,bm as f,bn as m,bo as b,a as x,C as w,P as g,I as p,b3 as v,ax as C,aB as y}from"./three-BHpSmIVb.js";import{d as A,g as j,j as T,k as M,l as U,F as k,o as F}from"./@vue-H0c_gk4m.js";const O=["#8c1dff","#f223ff","#ff2976","#ff901f","#ffd318"];(new a).load("../texture/meinv.jpg");const B=A({__name:"Index",setup(e){const a=new class extends s{constructor(){super(new x(0,0,400)),t(this,"material"),t(this,"dict",".'`^\",:;Il!i~+_-?][}{1)(|/tfjrxnuvczXYUJCLQ0OZmwqpdbkhao*#MW&8%B@$")}load(){var e;this.renderer.setClearColor(new w(0)),this.init("#webgl"),this.material=function(e){const t=new n,s=document.createElement("video");s.src="./texture/sintel.mp4",s.muted=!0,s.play();const a=new r(s),x=i("aUv"),w=i("aRandom"),g=l(a,x),p=o(O[0]).toColor(),v=o(O[1]).toColor(),C=o(O[2]).toColor(),y=o(O[3]).toColor(),A=o(O[4]).toColor(),j=d((()=>{const t=c(g.r,.5).add(w.x.mul(.03)),s=h(u().x.div(e.length).add(f(t.mul(e.length)).div(e.length)),u().y),a=l(e.asciiTexture,s);let n=p;return n=m(n,v,b(.2,t)).toColor(),n=m(n,C,b(.4,t)).toColor(),n=m(n,y,b(.6,t)).toColor(),n=m(n,A,b(.8,t)).toColor(),a.mul(n)}));return t.colorNode=j(),t}({asciiTexture:this.createAsciiTexture(),length:this.dict.length}),this.addObject(),null==(e=this.renderer)||e.setAnimationLoop((()=>{var e,t;null==(e=this.stats)||e.begin(),this.renderer.renderAsync(this.scene,this.camera),null==(t=this.stats)||t.end()}))}addObject(){var e;const t=50,s=2500,a=10,n=new g(a,a),r=new p(n,this.material,s);let i=new Float32Array(5e3);const l=new Float32Array(s);for(let o=0;o<50;o++)for(let e=0;e<t;e++){const s=o*t+e,n=o*a-250,d=e*a-250,c=0,h=new y;h.makeTranslation(n,d,c),r.setMatrixAt(s,h),i[2*s]=o/49,i[2*s+1]=e/49,l[s]=Math.pow(Math.random(),40)}r.instanceMatrix.needsUpdate=!0,n.setAttribute("aUv",new v(i,2)),n.setAttribute("aRandom",new v(l,1)),null==(e=this.scene)||e.add(r)}createAsciiTexture(){const e=document.createElement("canvas"),t=e.getContext("2d");e.width=64*this.dict.length,e.height=64,t.fillStyle="#000",t.fillRect(0,0,e.width,e.height),t.fillStyle="#fff",t.font="bold 34px monospace",t.textAlign="center";for(let a=0;a<this.dict.length;a++)if(a>30)for(let e=0;e<6;e++)t.filter=`blur(${e}px)`,t.fillText(this.dict[a],64*a+32,46);else t.filter="none",t.fillText(this.dict[a],64*a+32,46);const s=new C(e);return s.needsUpdate=!0,s}createVideoTexture(){}animate(){var e,t;null==(e=this.stats)||e.begin(),this.timer=requestAnimationFrame((()=>{this.animate()})),this.renderer.renderAsync(this.scene,this.camera),null==(t=this.stats)||t.end()}};return j((()=>{a.load()})),T((()=>{a.destroy()})),(e,t)=>(F(),M(k,null,[t[0]||(t[0]=U("div",{id:"webgl"},null,-1)),t[1]||(t[1]=U("div",{class:"title-name"},"ascii",-1))],64))}});export{B as default};

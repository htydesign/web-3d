var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{B as s}from"./base-EaBVrMG2.js";import{G as a,R as r,V as n,ad as i,j as o,ae as l,M as h,e as d}from"./three-BSKMsEwc.js";import{d as m,r as c,A as u,B as p,g as v,j as y,F as g,k as f,v as w,o as C,y as b}from"./@vue-Di8-S161.js";import{_ as j}from"./index-DE5yqdOr.js";import"./pinia-DWfFl6d1.js";import"./vue-router-COulN1-g.js";const k=["data-geometry"],G=["data-type"],M=j(m({__name:"ControlView",setup(e){const m=[{name:"立方体",geometry:"BoxGeometry"}],j=[{type:"translate",name:"移动"},{type:"scale",name:"缩放"},{type:"rotate",name:"旋转"}],M=c(!1);const x=new class extends s{constructor(){super(),t(this,"meshGroup",new a),t(this,"raycaster",new r),t(this,"pointer",new n),t(this,"transformControls"),t(this,"selectGroup",new a),t(this,"selectMesh")}load(){var e,t;this.init("#webgl"),null==(e=this.renderer)||e.setClearColor(1118481),null==(t=this.scene)||t.add(this.meshGroup,this.selectGroup),this.transformControls=new i(this.camera,this.renderer.domElement),this.animate(),this.gridHelper(1e3,100),this.transformControls.addEventListener("dragging-changed",(e=>{this.controls.enabled=!e.value})),this.transformControls.addEventListener("mouseDown",(e=>{})),window.addEventListener("click",(e=>{var t,s;this.pointer.x=e.clientX/this.innerWidth*2-1,this.pointer.y=-e.clientY/this.innerHeight*2+1,this.raycaster.setFromCamera(this.pointer,this.camera);const a=this.raycaster.intersectObjects(this.meshGroup.children);if(a.length){this.selectMesh=a[0].object,this.transformControls.attach(this.selectMesh);const e=null==(t=this.transformControls)?void 0:t.getHelper();null==(s=this.scene)||s.add(e)}}))}setMode(e){var t;null==(t=this.transformControls)||t.setMode(e)}addObject(e){if("BoxGeometry"===e){const e=new o(20,20,20),t=new l({color:16777215,emissive:4473924,flatShading:!0}),s=new h(e,t);this.meshGroup.add(s)}}restore(){var e;null==(e=this.transformControls)||e.reset()}animate(){var e,t;null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),d.update(),this.renderer.render(this.scene,this.camera),null==(t=this.stats)||t.end()}},_=e=>{const{dataset:t}=e.target;x.addObject(t.geometry),M.value=!0},B=e=>{const{dataset:t}=e.target;x.setMode(t.type)},E=()=>{x.restore()};return u((()=>{x.load()})),p((()=>{x.gui.close(),x.gui.destroy()})),(e,t)=>(C(),v(g,null,[t[0]||(t[0]=y("div",{id:"webgl"},null,-1)),t[1]||(t[1]=y("div",{class:"title-name"},"control",-1)),y("div",{class:"mesh",onClick:_},[(C(),v(g,null,f(m,((e,t)=>y("div",{class:"mesh-item",key:t,"data-geometry":e.geometry},b(e.name),9,k))),64))]),M.value?(C(),v("div",{key:0,class:"mesh controlFn",onClick:B},[(C(),v(g,null,f(j,((e,t)=>y("div",{class:"mesh-item",key:t,"data-type":e.type},b(e.name),9,G))),64))])):w("",!0),M.value?(C(),v("div",{key:1,class:"restore",onClick:E},"恢复")):w("",!0)],64))}}),[["__scopeId","data-v-29057c1e"]]);export{M as default};

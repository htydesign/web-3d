var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{W as s}from"./webgpuBasic-D-mbSDH1.js";import{T as a,bc as n,aU as r,bd as i,be as l,bf as o,bg as d,bh as c,bi as h,bj as u,bk as f,bl as m,bm as b,a as w,C as x,P as g,I as p,b2 as v,aw as A,aA as C}from"./three-CQ-nF5qD.js";import{d as y,z as j,A as T,g as U,j as M,F,o as O}from"./@vue-DISYwsDo.js";const k=["#8c1dff","#f223ff","#ff2976","#ff901f","#ffd318"];(new a).load("../texture/meinv.jpg");const I=y({__name:"Index",setup(e){const a=new class extends s{constructor(){super(new w(0,0,400)),t(this,"material"),t(this,"dict",".'`^\",:;Il!i~+_-?][}{1)(|/tfjrxnuvczXYUJCLQ0OZmwqpdbkhao*#MW&8%B@$")}load(){var e;this.renderer.setClearColor(new x(0)),this.init("#webgl"),this.material=function(e){const t=new n,s=document.createElement("video");s.src="./texture/sintel.mp4",s.muted=!0,s.play();const a=new r(s),w=i("aUv"),x=i("aRandom"),g=l(a,w),p=o(k[0]).toColor(),v=o(k[1]).toColor(),A=o(k[2]).toColor(),C=o(k[3]).toColor(),y=o(k[4]).toColor(),j=d((()=>{const t=c(g.r,.5).add(x.x.mul(.03)),s=h(u().x.div(e.length).add(f(t.mul(e.length)).div(e.length)),u().y),a=l(e.asciiTexture,s);let n=p;return n=m(n,v,b(.2,t)).toColor(),n=m(n,A,b(.4,t)).toColor(),n=m(n,C,b(.6,t)).toColor(),n=m(n,y,b(.8,t)).toColor(),a.mul(n)}));return t.colorNode=j(),t}({asciiTexture:this.createAsciiTexture(),length:this.dict.length}),this.addObject(),null==(e=this.renderer)||e.setAnimationLoop((()=>{var e,t;null==(e=this.stats)||e.begin(),this.renderer.renderAsync(this.scene,this.camera),null==(t=this.stats)||t.end()}))}addObject(){var e;const t=50,s=2500,a=10,n=new g(a,a),r=new p(n,this.material,s);let i=new Float32Array(5e3);const l=new Float32Array(s);for(let o=0;o<50;o++)for(let e=0;e<t;e++){const s=o*t+e,n=o*a-250,d=e*a-250,c=0,h=new C;h.makeTranslation(n,d,c),r.setMatrixAt(s,h),i[2*s]=o/49,i[2*s+1]=e/49,l[s]=Math.pow(Math.random(),40)}r.instanceMatrix.needsUpdate=!0,n.setAttribute("aUv",new v(i,2)),n.setAttribute("aRandom",new v(l,1)),null==(e=this.scene)||e.add(r)}createAsciiTexture(){const e=document.createElement("canvas"),t=e.getContext("2d");e.width=64*this.dict.length,e.height=64,t.fillStyle="#000",t.fillRect(0,0,e.width,e.height),t.fillStyle="#fff",t.font="bold 34px monospace",t.textAlign="center";for(let a=0;a<this.dict.length;a++)if(a>30)for(let e=0;e<6;e++)t.filter=`blur(${e}px)`,t.fillText(this.dict[a],64*a+32,46);else t.filter="none",t.fillText(this.dict[a],64*a+32,46);const s=new A(e);return s.needsUpdate=!0,s}createVideoTexture(){}animate(){var e,t;null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),this.renderer.renderAsync(this.scene,this.camera),null==(t=this.stats)||t.end()}};return j((()=>{a.load()})),T((()=>{a.destroy()})),(e,t)=>(O(),U(F,null,[t[0]||(t[0]=M("div",{id:"webgl"},null,-1)),t[1]||(t[1]=M("div",{class:"title-name"},"ascii",-1))],64))}});export{I as default};

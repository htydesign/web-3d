var e=Object.defineProperty,s=(s,t,i)=>((s,t,i)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i)(s,"symbol"!=typeof t?t+"":t,i);import{B as t}from"./base-T3lLSoS5.js";import{g as i}from"./modelLoader-Dk6PwQSq.js";import{d as a,z as l,A as r,g as o,j as n,F as d,o as h}from"./@vue-DISYwsDo.js";import{bd as m,G as c,aM as u,aB as M}from"./three-BLJ24qmy.js";const b=a({__name:"loaderMoreModel2",setup(e){const a=new class extends t{constructor(){var e;super(),s(this,"frustum",new m),s(this,"allModels",[]),s(this,"visibleModels",new c),null==(e=this.scene)||e.add(this.visibleModels)}load(){this.init("#webgl"),this.animate(),this.create(),this.sceneEnvironment()}create(){const e=1e3;i("./models/gltf/kira.glb").then((s=>{const t=s.scene;for(let i=0;i<200;i++){const s=t.clone();s.traverse((e=>{e.isMesh&&(e.frustumCulled=!1)})),s.scale.set(20,20,20),s.position.set(Math.random()*e-500,Math.random()*e-500,Math.random()*e-500),this.allModels.push(s),this.visibleModels.add(s)}}))}checkVisibility(e){const s=new M;s.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.frustum.setFromProjectionMatrix(s);const t=(new u).setFromObject(e);this.frustum.intersectsBox(t)?this.visibleModels.children.find((s=>s.uuid===e.uuid))||this.visibleModels.add(e):this.visibleModels.remove(e)}animate(){var e,s;null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),this.renderer.render(this.scene,this.camera),null==(s=this.stats)||s.end()}};return l((()=>{a.load()})),r((()=>{a.destroy(),a.allModels.length=0,a.visibleModels.children.length=0})),(e,s)=>(h(),o(d,null,[s[0]||(s[0]=n("div",{id:"webgl"},null,-1)),s[1]||(s[1]=n("div",{class:"title-name"},"大量模型(200个，11.6M大小的模型)",-1))],64))}});export{b as default};

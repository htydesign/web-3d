var e=Object.defineProperty,t=(t,a,n)=>((t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n)(t,"symbol"!=typeof a?a+"":a,n);import{B as a}from"./base-DAtrNvXQ.js";import{V as n,y as r,z as s,a2 as i,a as o,aN as l,M as c}from"./three-Bt21RtHy.js";import{d as h,z as m,A as d,g as u,j as v,F as p,o as f}from"./@vue-B4sUqkWa.js";const g=h({__name:"ModelView2",setup(e){const h=new class extends a{constructor(){super(),t(this,"texture"),t(this,"mixer"),t(this,"composer"),t(this,"unifors",{u_center:{value:new n(.3,.3)}})}load(){this.init("#webgl"),this.animate(),this.light(),this.gridHelper(),this.create()}create(){var e;null==(e=this.camera)||e.position.set(0,3,4);const t=new r,a=new s;a.setDecoderPath("./draco/"),t.setDRACOLoader(a),t.load("./models/model04.gltf",(e=>{var t,a;const n=e.scene;this.mixer=new i(n);const r=this.mixer.clipAction(e.animations[0]),s=this.mixer.clipAction(e.animations[2]),h=this.mixer.clipAction(e.animations[4]);s.play(),r.play(),h.play(),s.timeScale=5;const m=new o({color:16777215,wireframe:!0,transparent:!0,opacity:.75}),d=new l({color:16711680,transparent:!0,opacity:.5}),u=n;u.traverse((e=>{e instanceof c&&(e.material=m)})),null==(t=this.scene)||t.add(u);const v=n.clone();v.traverse((e=>{e instanceof c&&(e.material=d,e.material.transparent=!0,e.material.onBeforeCompile=e=>{Object.assign(e.uniforms,this.unifors),e.vertexShader=`\n            varying vec2 vUv;\n            ${e.vertexShader}\n            `,e.vertexShader=e.vertexShader.replace("#include <fog_vertex>","\n            #include <fog_vertex>\n            vUv = uv;\n            "),e.fragmentShader=`\n            varying vec2 vUv;\n            uniform vec2 u_center; // 添加这一行\n            ${e.fragmentShader}\n            `,e.fragmentShader=e.fragmentShader.replace("#include <dithering_fragment>","\n            #include <dithering_fragment>\n            vec3 bubbleColor = vec3(1.0); // 乳白色\n            float distanceToCenter = distance(vUv, u_center);\n            // 计算透明度，可以根据实际需要调整\n            float alpha = smoothstep(1.0, 0.5, distanceToCenter);\n            gl_FragColor = vec4(bubbleColor*alpha, 1.0);\n            ")})})),null==(a=this.scene)||a.add(v)}))}animate(){var e,t,a;null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),this.mixer&&(null==(t=this.mixer)||t.update(this.clock.getDelta())),this.renderer.render(this.scene,this.camera);const n=this.clock.getElapsedTime();this.unifors.u_center.value.x=.5*Math.sin(n)+.5,this.unifors.u_center.value.y=.5*Math.cos(n)+.5,null==(a=this.stats)||a.end()}};return m((()=>{h.load()})),d((()=>{h.gui.close(),h.gui.destroy()})),(e,t)=>(f(),u(p,null,[t[0]||(t[0]=v("div",{id:"webgl"},null,-1)),t[1]||(t[1]=v("div",{class:"title-name"},"模型2",-1))],64))}});export{g as default};

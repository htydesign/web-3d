var e=Object.defineProperty,t=(t,o,r)=>((t,o,r)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r)(t,"symbol"!=typeof o?o+"":o,r);import{B as o}from"./base-BaImv3YL.js";import{d as r,z as n,A as a,g as s,j as l,F as i,o as u}from"./@vue-DISYwsDo.js";import{G as d,R as h,V as C,T as m,ay as g,A as v,C as c,ax as p}from"./three-CyihR34C.js";import{_ as w}from"./index-Dd2VcruH.js";import"./pinia-DkR6u-JQ.js";import"./vue-router-kKGLm7zb.js";const f=w(r({__name:"HeatMapView",setup(e){const r=new class extends o{constructor(){super(),t(this,"group",new d),t(this,"measureGroup",new d),t(this,"raycaster",new h),t(this,"pointer",new C),t(this,"startMeasure",!1),t(this,"arr",[]),t(this,"isMove",!1)}load(){var e;this.init("#webgl"),this.animate(),null==(e=this.scene)||e.add(this.group),this.scene.add(this.measureGroup),this.create()}create(){var e;const t=(new m).load("./texture/sprite.png"),o=new g({blending:v,transparent:!0,depthTest:!1}),r={uTexture:{value:t},uHightColor:{value:new c(16777215)},uLowColor:{value:new c(16777215)},uCenterColor:{value:new c(16777215)}},n={uHightColor:16777215,uLowColor:16777215,uCenterColor:16777215};this.gui.addColor(n,"uCenterColor").name("中心点").onChange((()=>{r.uCenterColor.value=new c(n.uCenterColor)})),this.gui.addColor(n,"uHightColor").name("高亮").onChange((()=>{r.uHightColor.value=new c(n.uHightColor)})),this.gui.addColor(n,"uLowColor").name("边缘").onChange((()=>{r.uLowColor.value=new c(n.uLowColor)})),o.onBeforeCompile=e=>{Object.assign(e.uniforms,r),e.vertexShader=`\n        varying vec2 vUv;\n        ${e.vertexShader}\n      `,e.vertexShader=e.vertexShader.replace("#include <fog_vertex>","\n        #include <fog_vertex>  \n        vUv = uv;    \n      "),e.fragmentShader=`\n        varying vec2 vUv;\n        uniform sampler2D uTexture;\n        uniform vec3 uHightColor;\n        uniform vec3 uLowColor;\n        uniform vec3 uCenterColor;\n        ${e.fragmentShader}\n      `,e.fragmentShader=e.fragmentShader.replace("#include <fog_fragment>","\n        #include <fog_fragment>\n\n        vec4 textColor = texture2D(uTexture, vUv);\n        vec3 newColor = textColor.rgb ;\n\n        if(textColor.a < 0.5){\n          newColor = uLowColor;\n        }else if(textColor.a > 0.5 && textColor.a < 0.75) {        \n          float t = smoothstep(0.5,0.75,textColor.a);\n          newColor = mix(uLowColor,uHightColor,t);\n        }else {\n          float t = smoothstep(0.75,1.0,textColor.a);\n          newColor = mix(uHightColor,uCenterColor,t);          \n        }        \n        gl_FragColor = vec4(newColor,textColor.a);      \n      ")};for(let a=0;a<100;a++){const t=new p(o);t.scale.set(20,20,20),t.position.set(100*Math.random()-50,0,100*Math.random()-50),null==(e=this.scene)||e.add(t)}}createSpriteMap(){const e=document.createElement("canvas"),t=e.getContext("2d");e.style.width="200px",e.style.height="200px",e.width=100,e.height=100;const o=t.createRadialGradient(50,50,0,50,50,50);return o.addColorStop(0,"rgba(255,255,255,1)"),o.addColorStop(1,"rgba(255,255,255,0)"),t.fillStyle=o,t.fillRect(0,0,100,100),e}animate(){var e,t;null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),this.renderer&&this.renderer.render(this.scene,this.camera),null==(t=this.stats)||t.end()}};return n((()=>{r.load()})),a((()=>{r.destroy()})),(e,t)=>(u(),s(i,null,[t[0]||(t[0]=l("div",{id:"webgl"},null,-1)),t[1]||(t[1]=l("div",{class:"title-name"},"热力图",-1))],64))}}),[["__scopeId","data-v-bbb0b4d4"]]);export{f as default};

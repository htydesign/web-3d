var e=Object.defineProperty,t=(t,a,s)=>((t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s)(t,"symbol"!=typeof a?a+"":a,s);import{B as a}from"./base-D8exnqXt.js";import{T as s,a as r,G as i,b as n,P as o,M as l,a2 as x,aP as h,aQ as p,aR as c,aS as m,s as g,aT as u,a5 as d}from"./three-aFiGC2Cx.js";import{d as v,r as w,z as y,A as j,g as A,j as f,x as b,v as M,F as P,o as z}from"./@vue-DISYwsDo.js";const S={key:0,class:"loading"},F=v({__name:"ImageView",setup(e){const v=w(0),F=["vortex11-267x400.jpg","vortex12-320x400.jpg","vortex15-330x400.png","vortex20-267x400.jpg","vortex23-267x400.jpeg","vortex25-400x366.jpeg","vortex26-267x400.jpg","vortex31-267x400.jpg","vortex32-321x400.jpg","vortex33-267x400.jpg","vortex34-267x400.jpg","vortex35-320x400.jpg","vortex36-400x400.jpg","vortex37-320x400.jpg","vortex38-400x267.jpg"];const I=new class extends a{constructor(){super(),t(this,"mixer"),t(this,"mixerArray",[]),t(this,"timeScale",3),t(this,"textureMap",[])}load(){var e,t;this.init("#webgl"),this.animate(),this.loadImage(),null==(e=this.camera)||e.position.set(0,0,350),null==(t=this.controls)||t.update()}loadImage(){const e=new s,t=[];let a=0;F.forEach((s=>{t.push(new Promise((t=>{e.load("./texture/img-vortex/"+s,(e=>{t(e),a++,v.value=a/F.length*100}),(e=>{}),(()=>{}))})))})),Promise.all(t).then((e=>{this.textureMap.push(...e);for(let t=0;t<6;t++){const e=t/6*Math.PI*2,a=300*Math.cos(e),s=300*Math.sin(e);this.createPlane(new r(a,s,0),e)}setTimeout((()=>{for(let e=0;e<this.mixerArray.length;e++)this.mixerArray[e].timeScale=1}),1e3)}))}createPlane(e,t){var a;const s=new i;s.position.copy(e),s.rotateZ(t),null==(a=this.scene)||a.add(s);for(let i=0;i<this.textureMap.length-1;i++){const{width:e,height:t}=this.textureMap[i].source.data,a=new n(new o(e/5,t/5),new l({opacity:.75,transparent:!0,depthTest:!1,map:this.textureMap[i]}));s.add(a);const d=[0,4,5,6,7,7],v=new r(0,0,1),w=(new x).setFromAxisAngle(v,0),y=(new x).setFromAxisAngle(v,-.3),j=new h(".quaternion",d,[w.x,w.y,w.z,w.w,y.x,y.y,y.z,y.w,y.x,y.y,y.z,y.w,y.x,y.y,y.z,y.w,y.x,y.y,y.z,y.w,w.x,w.y,w.z,w.w]),A=new p(".position",d,[0,80,-80,0,-20,-20,-50,-20,20,-170,-20,0,-230,-50,-90,0,80,-80]),f=new p(".scale",d,[1,1,1,1,1,1,.8,.8,.8,.5,.5,.5,.01,.01,.01,1,1,1]),b=new c(".material.opacity",d,[0,1,1,1,1,0]),M=new m("Action0",d[d.length-1],[b,f,A,j]),P=new g(s.children[i]),z=P.clipAction(M);z.loop=u,z.time=i/2,z.play(),P.timeScale=this.timeScale,this.mixerArray.push(P)}}animate(){var e,t;null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),d.update(),this.renderer.render(this.scene,this.camera);const a=this.clock.getDelta();for(let s=0;s<this.mixerArray.length;s++)this.mixerArray[s].update(a);null==(t=this.stats)||t.end()}};return y((()=>{I.load()})),j((()=>{I.destroy()})),(e,t)=>(z(),A(P,null,[t[0]||(t[0]=f("div",{id:"webgl"},null,-1)),100!=v.value?(z(),A("div",S,"加载进度..."+b(v.value)+"%",1)):M("",!0)],64))}});export{F as default};

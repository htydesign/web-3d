var e=Object.defineProperty,n=(n,a,o)=>((n,a,o)=>a in n?e(n,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[a]=o)(n,"symbol"!=typeof a?a+"":a,o);import{B as a}from"./base-DI5EaenM.js";import{C as o,V as r,Z as t,s as i,k as s,t as u,$ as l,u as m,b as d}from"./three-1nqLwmXn.js";import{d as v,z as c,A as h,g as f,o as w}from"./@vue-B4sUqkWa.js";const p={id:"webgl"},g=v({__name:"CurveLineView",setup(e){const v=new class extends a{constructor(){super(),n(this,"uniforms",{uStartColor:{value:new o(16777215)}})}load(){this.init("#webgl"),this.animate(),this.create()}create(){for(let e=0;e<100;e++){const n=new r(Math.sin(Math.PI*e*2/100)*Math.random()*200,50*Math.random()-50,Math.cos(Math.PI*e*2/100)*Math.random()*200),a=new r;a.addVectors(new r(0,0,0),n).multiplyScalar(.5),a.y=50*Math.random()+50,this.createCurveLineMesh(a,n)}this.gui.addColor(this.uniforms.uStartColor,"value").onChange((e=>{this.uniforms.uStartColor.value=e}))}createCurveLineMesh(e,n){var a;const v=new r(0,0,0),c=new t(v,e,n).getPoints(50),h=new i;for(let o=0;o<c.length-1;o++)h.curves.push(new s(c[o],c[o+1]));const f=new u(h,20,.5,8,!1),w={uTime:{value:1},uSpeed:{value:0},uFade:{value:new l(0,1)},uStartColor:{value:new o(16777215)},uColor:{value:new o(Math.random(),Math.random(),Math.random())}},p=new m({uniforms:w,transparent:!0,vertexShader:"\n        varying vec2 vUv;\n        void main(){\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      ",fragmentShader:"\n        uniform float uTime;\n        uniform vec2 uFade;\n        uniform vec3 uStartColor;\n        uniform vec3 uColor;\n        uniform float uSpeed;\n        varying vec2 vUv;\n        void main(){\n            vec3 color = vec3(1.0,1.0,1.0);\n            vec3 color3 = mix(color, uColor, vUv.x);\n\n            float d = mod((vUv.x-uTime) * 1.0 ,1.0);\n\n             if(d >= 0.95){\n                color3 = vec3(uStartColor);\n            }\n\n            if(d > uFade.y){\n              discard;\n            }else {\n              //平滑透明度渐变\n              float alpha = smoothstep(uFade.x, uFade.y, d);\n              //透明度太小时不显示\n              if(alpha < 0.001){\n                discard;\n              }\n              gl_FragColor = vec4(color3,alpha);\n            }\n        }\n      "}),g=new d(f,p),C=.005*Math.random()+.005;g.onBeforeRender=()=>{p.uniforms.uTime.value+=C,p.uniforms.uTime.value>1&&(p.uniforms.uTime.value=0)},null==(a=this.scene)||a.add(g)}animate(){var e,n;null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),this.renderer.render(this.scene,this.camera),null==(n=this.stats)||n.end()}};return c((()=>{v.load()})),h((()=>{v.gui.close(),v.gui.destroy()})),(e,n)=>(w(),f("div",p))}});export{g as default};

var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{W as s}from"./webgpuBasic-C_Kl0-V1.js";import{bc as a,bd as n,be as i,bf as r,bg as l,bh as o,bi as d,bj as c,bk as h,bl as u,bm as f,bn as b,bo as m,bp as w,bq as p,br as x,bs as g,bt as v,bu as A,bv as y}from"./three-DbIXC9SN.js";import{d as j,z as T,A as M,g as U,j as k,F as C,o as F}from"./@vue-DISYwsDo.js";const O=["#8c1dff","#f223ff","#ff2976","#ff901f","#ffd318"];(new a).load("../texture/meinv.jpg");const q=j({__name:"Index",setup(e){const a=new class extends s{constructor(){super(new w(0,0,400)),t(this,"material"),t(this,"dict",".'`^\",:;Il!i~+_-?][}{1)(|/tfjrxnuvczXYUJCLQ0OZmwqpdbkhao*#MW&8%B@$")}load(){var e;this.renderer.setClearColor(new p(0)),this.init("#webgl"),this.material=function(e){const t=new n,s=document.createElement("video");s.src="./texture/sintel.mp4",s.muted=!0,s.play();const a=new i(s),w=r("aUv"),p=r("aRandom"),x=l(a,w),g=o((()=>{const t=d(x.r,.5).add(p.x.mul(.03)),s=c(h().x.div(e.length).add(u(t.mul(e.length)).div(e.length)),h().y),a=l(e.asciiTexture,s);let n=f(O[0]);return n=b(n,f(O[1]),m(.2,t)),n=b(n,f(O[2]),m(.4,t)),n=b(n,f(O[3]),m(.6,t)),n=b(n,f(O[4]),m(.8,t)),a.mul(n)}));return t.colorNode=g(),t}({asciiTexture:this.createAsciiTexture(),length:this.dict.length}),this.addObject(),null==(e=this.renderer)||e.setAnimationLoop((()=>{var e,t;null==(e=this.stats)||e.begin(),this.renderer.renderAsync(this.scene,this.camera),null==(t=this.stats)||t.end()}))}addObject(){var e;const t=50,s=2500,a=10,n=new x(a,a),i=new g(n,this.material,s);let r=new Float32Array(5e3);const l=new Float32Array(s);for(let o=0;o<50;o++)for(let e=0;e<t;e++){const s=o*t+e,n=o*a-250,d=e*a-250,c=0,h=new y;h.makeTranslation(n,d,c),i.setMatrixAt(s,h),r[2*s]=o/49,r[2*s+1]=e/49,l[s]=Math.pow(Math.random(),40)}i.instanceMatrix.needsUpdate=!0,n.setAttribute("aUv",new v(r,2)),n.setAttribute("aRandom",new v(l,1)),null==(e=this.scene)||e.add(i)}createAsciiTexture(){const e=document.createElement("canvas"),t=e.getContext("2d");e.width=64*this.dict.length,e.height=64,t.fillStyle="#000",t.fillRect(0,0,e.width,e.height),t.fillStyle="#fff",t.font="bold 34px monospace",t.textAlign="center";for(let a=0;a<this.dict.length;a++)if(a>30)for(let e=0;e<6;e++)t.filter=`blur(${e}px)`,t.fillText(this.dict[a],64*a+32,46);else t.filter="none",t.fillText(this.dict[a],64*a+32,46);const s=new A(e);return s.needsUpdate=!0,s}createVideoTexture(){}animate(){var e,t;null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),this.renderer.renderAsync(this.scene,this.camera),null==(t=this.stats)||t.end()}};return T((()=>{a.load()})),M((()=>{a.destroy()})),(e,t)=>(F(),U(C,null,[t[0]||(t[0]=k("div",{id:"webgl"},null,-1)),t[1]||(t[1]=k("div",{class:"title-name"},"ascii",-1))],64))}});export{q as default};

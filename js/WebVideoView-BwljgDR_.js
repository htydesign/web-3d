import{B as e}from"./base-HDikCi6F.js";import{d as a,r as t,g as s,j as n,k as i,l as r,o}from"./@vue-H0c_gk4m.js";import{C as l,b as c,B as d,M as u,T as v,P as m}from"./three-BHpSmIVb.js";import{_ as f}from"./index-DcliGhKH.js";import"./pinia-DiTk8w0t.js";import"./vue-router-DusXlGQI.js";const p={class:"video-container"},h=f(a({__name:"WebVideoView",setup(a){const f=t(null);let h=null;const w=t(0),b=async e=>{h&&h.getTracks().forEach((e=>e.stop()));try{const a=(e=>({video:{deviceId:e?{exact:e.deviceId}:void 0,facingMode:e?void 0:"user"},audio:!1}))(e),t=await navigator.mediaDevices.getUserMedia(a);f.value&&(f.value.srcObject=t,f.value.play(),e&&/back|rear/i.test(e.label)?f.value.style.transform="scaleX(1)":f.value.style.transform="scaleX(-1)"),h=t}catch(a){}},g=async()=>{const e=await(async()=>(await navigator.mediaDevices.enumerateDevices()).filter((e=>"videoinput"===e.kind)))();if(!e||0===e.length)return;w.value>=e.length-1?w.value=0:w.value++;const a=e[w.value];b(a||null)},y=async()=>{const e=(await navigator.mediaDevices.enumerateDevices()).find((e=>"videoinput"===e.kind&&/back|rear/i.test(e.label)));e&&b(e)};const k=new class extends e{constructor(){super()}load(){this.init("#webgl"),this.animate(),this.scene.background=new l(3355443),this.create()}create(){var e,a;null==(e=this.scene)||e.add(new c(new d(10,10,10),new u({color:16711680})));const t=(new v).load("./texture/sky.jpg");t.offset.set(0,.5);const s=new u({color:16724736,map:t,transparent:!0}),n=new c(new m(100,100),s);null==(a=this.scene)||a.add(n)}animate(){var e,a;null==(e=this.stats)||e.begin(),this.timer=requestAnimationFrame((()=>{this.animate()})),this.renderer&&this.renderer.render(this.scene,this.camera),null==(a=this.stats)||a.end()}};return s((()=>{k.load(),b(null)})),n((()=>{k.destroy()})),(e,a)=>(o(),i("div",p,[r("button",{onClick:g,style:{top:"5%",left:"10%"}},"切换摄像头"),r("button",{onClick:y,style:{top:"15%",left:"10%"}},"后置摄像头"),r("video",{ref_key:"videoRef",ref:f,playsinline:""},null,512),a[0]||(a[0]=r("div",{id:"webgl"},null,-1))]))}}),[["__scopeId","data-v-f77af38f"]]);export{h as default};

var s=Object.defineProperty,t=(t,e,i)=>((t,e,i)=>e in t?s(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i)(t,"symbol"!=typeof e?e+"":e,i);import{W as e}from"./webgpuBasic-D-mbSDH1.js";import{bp as i,a as o,C as n,T as a,aV as r,P as l,bz as u,D as c,bg as d,by as m,bA as b,bB as h,bw as p,bh as g,b as x,bC as v,bD as w,bi as P,bE as j,bF as f,bv as y,bG as A,bH as T,bI as _,bJ as C,bK as N,bl as V,bu as z}from"./three-CQ-nF5qD.js";import{V as I}from"./virtual-scroll-Dtm-vLdV.js";import{d as O,z as S,A as B,g as D,j as F,F as E,o as G}from"./@vue-DISYwsDo.js";import{_ as H}from"./index-261N8x7R.js";import"./@amap-Bx2D3lnM.js";import"./pinia-DkR6u-JQ.js";import"./vue-router-kKGLm7zb.js";const J=H(O({__name:"Index",setup(s){const O=new class extends e{constructor(){super(new o(0,0,50)),t(this,"material"),t(this,"slides",[]),t(this,"count",200),t(this,"scrollPosition",0),t(this,"postProcessing"),t(this,"uTime",i(0))}load(){var s,t;this.renderer.setClearColor(new n(0)),this.init("#webgl"),this.addObject(),null==(s=this.controls)||s.dispose(),this.initPostProcessing(),null==(t=this.renderer)||t.setAnimationLoop((()=>{var s,t;null==(s=this.stats)||s.begin(),this.time+=.01,this.uTime.value=this.time,this.slides.map((s=>{s.mesh.position.x=s.originalPosition+this.scrollPosition})),this.renderer.renderAsync(this.scene,this.camera),this.postProcessing.renderAsync(),null==(t=this.stats)||t.end()}));(new I).on((s=>{this.scrollPosition=s.y/10}))}addObject(){var s;const t=(new a).load("./texture/meinv.jpg");t.colorSpace=r;const e=(new a).load("./texture/ocean.jpg");e.colorSpace=r;const i=(new a).load("./texture/vc2.jpg");i.colorSpace=r;const o=[t,e,i],n=new l(40,60,10,10),v=new u({side:c});v.positionNode=d((()=>{const s=m.xyz.toVar(),t=b.mul(s);let e=h(t.x);return s.y.mulAssign(p(.8).add(g(e.mul(.01),2))),s}))();for(let a=0;a<this.count;a++){const t=v.clone();t.map=o[a%o.length];const e=new x(n,t);e.position.x=40*a-40*this.count/2,null==(s=this.scene)||s.add(e),this.slides.push({mesh:e,index:a,originalPosition:e.position.x})}}initPostProcessing(){this.postProcessing=new v(this.renderer);const s=w(this.scene,this.camera).getTextureNode(),t=d((([s,t])=>{const e=s.sub(P(.5)).toVar();e.x.subAssign(j(e.x));const i=f(s.x.sub(.5).div(.5));return e.x.mulAssign(p(1).sub(g(f(e.x),p(.5).mul(.6)))),e.y.mulAssign(p(1).sub(p(.5).mul(g(i,p(1.5))))),e.x.addAssign(this.uTime.mul(.05).mul(j(s.x.sub(.5)))),e.mulAssign(p(100).mul(t)),e})),e=y(.1,.5,f(A.x.sub(.5))),i=y(.2,.5,f(A.x.sub(.5))).oneMinus(),o=t(A,.5),n=t(A,1),a=T(o),r=T(n),l=a.add(r).mul(_.mul(2)),u=P(C(l),N(l)),c=A.add(u.mul(a.mul(.05))),m=V(A,c,e),b=V(z(0,0,0,1),s.sample(m),i);this.postProcessing.outputNode=z(a,0,0,1),this.postProcessing.outputNode=b}};return S((()=>{O.load()})),B((()=>{O.destroy()})),(s,t)=>(G(),D(E,null,[t[0]||(t[0]=F("div",{id:"webgl"},null,-1)),t[1]||(t[1]=F("div",{class:"title-name"},"bend(滚动滚轮)",-1))],64))}}),[["__scopeId","data-v-e034afbb"]]);export{J as default};

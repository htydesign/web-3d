var t=Object.defineProperty,e=(e,n,o)=>((e,n,o)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o)(e,"symbol"!=typeof n?n+"":n,o);import{B as n}from"./base-DbQo_w83.js";import{G as o,C as a,Y as s,a5 as i,M as r,b as h,a6 as d,a7 as c,F as w,H as l,E as u,a8 as M,a as m,c as p,a9 as P}from"./three-C8kJxG0b.js";import{d as I,z as x,A as g,g as f,j as b,F as B,o as y}from"./@vue-BDXyav1n.js";const v=I({__name:"BaguaView",setup(t){const I=new class extends n{constructor(){super(),e(this,"font"),e(this,"meshGroup",new o)}load(){var t,e,n;this.init("#webgl"),this.animate(),null==(t=this.scene)||t.add(this.meshGroup),null==(e=this.controls)||e.dispose(),null==(n=this.camera)||n.position.set(0,50,100),this.camera.aspect=this.innerWidth/this.innerHeight,this.camera.updateProjectionMatrix();for(let a=0;a<10;a++){const t=Math.pow(2,(o=3,s=6,o=Math.ceil(o),s=Math.floor(s),Math.floor(Math.random()*(s-o+1))+o));this.createRoundBorder(12+4.5*a,t).then((t=>{0===a&&this.create(),this.meshGroup.add(t),9===a&&this.update()}))}var o,s;this.scene.background=new a(3355443),this.loaderFont((()=>{}))}update(){this.meshGroup.children.forEach(((t,e)=>{e%2==0?new s.Tween(t.rotation).to({z:2*Math.PI},4e3).start():new s.Tween(t.rotation).to({z:2*-Math.PI},4e3).start()})),setTimeout((()=>{new s.Tween(this.meshGroup.rotation).to({x:-Math.PI/2},1e3).start().onComplete((()=>{this.meshGroup.children.forEach(((t,e)=>{0!==e&&(e%2==0?new s.Tween(t.rotation).to({x:2*Math.PI,y:2*Math.PI,z:2*Math.PI},4e3).delay(200*Math.random()*e).start():new s.Tween(t.rotation).to({x:2*-Math.PI,y:2*Math.PI,z:2*Math.PI},4e3).delay(200*Math.random()*e).start())}))}))}),2e3)}create(){const t=new o;this.meshGroup.add(t);const e=new i(10,32,0,Math.PI),n=new r({color:16777215}),a=new r({color:0}),s=new h(e,n),d=new h(e,a);d.rotateZ(Math.PI),t.add(s),t.add(d);const c=new i(5,32),w=new i(2,32),l=new r({color:0}),u=new r({color:16777215}),M=new h(c,l),m=new h(w,u);M.position.set(5,0,.5),m.position.set(6,0,1),s.add(M),s.add(m);const p=new i(5,32),P=new i(2,32),I=new r({color:16777215}),x=new r({color:0}),g=new h(p,I),f=new h(P,x);g.position.set(-5,0,.5),f.position.set(-6,0,1),s.add(g),s.add(f)}loaderFont(t){(new d).load("./fonts/droid/droid_sans_regular.typeface.json",(e=>{this.font=e,t(e)}))}createRoundBorder(t,e){return new Promise((n=>{if(this.font){const o=new c(t,2,2,100),a=new w(o),s=new l(a,new u({color:16777215}));for(let i=0;i<e;i++){const o=new M(i+1+"",{font:this.font,size:e>=24?.5:2,depth:.1});o.computeBoundingBox();const a=o.boundingBox?-.5*(o.boundingBox.max.x-o.boundingBox.min.x):0,d=o.boundingBox?-.5*(o.boundingBox.max.y-o.boundingBox.min.y):0;o.translate(a,d,0);const c=new h(o,new r({color:16777215}));c.position.set(Math.sin(i*(Math.PI/(e/2)))*(t-0),Math.cos(i*(Math.PI/(e/2)))*(t-0),0),c.rotateZ(-i*(Math.PI/(e/2))),s.add(c);const w=new u({color:16777215}),l=[];l.push(new m(Math.sin(i*(Math.PI/(e/2))+Math.PI/e)*(t+2),Math.cos(i*(Math.PI/(e/2))+Math.PI/e)*(t+2),0)),l.push(new m(Math.sin(i*(Math.PI/(e/2))+Math.PI/e)*(t-2),Math.cos(i*(Math.PI/(e/2))+Math.PI/e)*(t-2),0));const I=(new p).setFromPoints(l),x=new P(I,w);s.add(x),n(s)}}else this.loaderFont((o=>{const s=new c(t,2,2,100),i=new w(s),d=new l(i,new u({color:16777215}));if(Math.random()>.5){const t=new r({color:new a(0,0,0)}),e=new h(s,t);d.add(e)}for(let a=0;a<e;a++){const s=new M(a+1+"",{font:o,size:2,depth:.1});s.computeBoundingBox();const i=s.boundingBox?-.5*(s.boundingBox.max.x-s.boundingBox.min.x):0,c=s.boundingBox?-.5*(s.boundingBox.max.y-s.boundingBox.min.y):0;s.translate(i,c,0);const w=new h(s,new r({color:16777215}));w.position.set(Math.sin(a*(Math.PI/(e/2)))*(t-0),Math.cos(a*(Math.PI/(e/2)))*(t-0),0),w.rotateZ(-a*(Math.PI/(e/2))),d.add(w);const l=new u({color:16777215}),I=[];I.push(new m(Math.sin(a*(Math.PI/(e/2))+Math.PI/e)*(t+2),Math.cos(a*(Math.PI/(e/2))+Math.PI/e)*(t+2),0)),I.push(new m(Math.sin(a*(Math.PI/(e/2))+Math.PI/e)*(t-2),Math.cos(a*(Math.PI/(e/2))+Math.PI/e)*(t-2),0));const x=(new p).setFromPoints(I),g=new P(x,l);d.add(g),n(d)}}))}))}animate(){var t,e;null==(t=this.stats)||t.begin(),requestAnimationFrame((()=>{this.animate()})),s.update(),this.renderer.render(this.scene,this.camera),null==(e=this.stats)||e.end()}};return x((()=>{I.load()})),g((()=>{I.gui.close(),I.gui.destroy()})),(t,e)=>(y(),f(B,null,[e[0]||(e[0]=b("div",{id:"webgl"},null,-1)),e[1]||(e[1]=b("div",{class:"title-name"},"九宫八卦阵",-1))],64))}});export{v as default};

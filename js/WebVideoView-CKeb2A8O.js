import{B as e}from"./base-DI5EaenM.js";import{C as a,b as t,g as s,M as n,q as i,x as r}from"./three-1nqLwmXn.js";import{d as o,r as l,z as c,A as d,g as u,j as v,o as m}from"./@vue-B4sUqkWa.js";import{_ as p}from"./index-DhiNE6F4.js";import"./pinia-C4SihLJg.js";import"./vue-router-CANWKAPm.js";const f={class:"video-container"},h=p(o({__name:"WebVideoView",setup(o){const p=l(null);let h=null;const g=l(0),w=async e=>{h&&h.getTracks().forEach((e=>e.stop()));try{const a=(e=>({video:{deviceId:e?{exact:e.deviceId}:void 0,facingMode:e?void 0:"user"},audio:!1}))(e),t=await navigator.mediaDevices.getUserMedia(a);p.value&&(p.value.srcObject=t,p.value.play(),e&&/back|rear/i.test(e.label)?p.value.style.transform="scaleX(1)":p.value.style.transform="scaleX(-1)"),h=t}catch(a){}},b=async()=>{const e=await(async()=>(await navigator.mediaDevices.enumerateDevices()).filter((e=>"videoinput"===e.kind)))();if(!e||0===e.length)return;g.value>=e.length-1?g.value=0:g.value++;const a=e[g.value];w(a||null)},y=async()=>{const e=(await navigator.mediaDevices.enumerateDevices()).find((e=>"videoinput"===e.kind&&/back|rear/i.test(e.label)));e&&w(e)};const k=new class extends e{constructor(){super()}load(){this.init("#webgl"),this.animate(),this.scene.background=new a(3355443),this.create()}create(){var e,a;null==(e=this.scene)||e.add(new t(new s(10,10,10),new n({color:16711680})));const o=(new i).load("./texture/sky.jpg");o.offset.set(0,.5);const l=new n({color:16724736,map:o,transparent:!0}),c=new t(new r(100,100),l);null==(a=this.scene)||a.add(c)}animate(){var e,a;null==(e=this.stats)||e.begin(),requestAnimationFrame((()=>{this.animate()})),this.renderer&&this.renderer.render(this.scene,this.camera),null==(a=this.stats)||a.end()}};return c((()=>{k.load(),w(null)})),d((()=>{k.gui.close(),k.gui.destroy()})),(e,a)=>(m(),u("div",f,[v("button",{onClick:b,style:{top:"5%",left:"10%"}},"切换摄像头"),v("button",{onClick:y,style:{top:"15%",left:"10%"}},"后置摄像头"),v("video",{ref_key:"videoRef",ref:p,playsinline:""},null,512),a[0]||(a[0]=v("div",{id:"webgl"},null,-1))]))}}),[["__scopeId","data-v-b0c30626"]]);export{h as default};

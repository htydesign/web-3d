var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{W as s}from"./webgpuBasic-RWdrGxvh.js";import{bs as a,a as n,C as r,P as i,bC as o,T as l,aW as d,b_ as u,bi as c,bk as m,bx as h,bg as p,b$ as b,bh as g,c0 as x,bl as T,bK as w,c1 as v,bn as y,bB as P,c2 as j,bN as f,bA as z,bz as C,c3 as _,b as A,ax as I,bF as S,bG as V}from"./three-BHpSmIVb.js";import{d as L,g as N,j as O,k as U,l as k,F as B,o as E}from"./@vue-H0c_gk4m.js";import{_ as F}from"./index-DcliGhKH.js";import"./pinia-DiTk8w0t.js";import"./vue-router-DusXlGQI.js";const M=F(L({__name:"Index",setup(e){const L=new class extends s{constructor(){super(new n(0,0,50)),t(this,"uTime",a(0)),t(this,"postProcessing")}load(){var e;this.renderer.setClearColor(new r(6710886)),this.init("#webgl"),this.addObject(),this.sceneEnvironment(),this.initPostProcessing(),null==(e=this.renderer)||e.setAnimationLoop((()=>{var e,t;null==(e=this.stats)||e.begin(),this.time+=.01,this.uTime.value=this.time,this.postProcessing.renderAsync(),null==(t=this.stats)||t.end()}))}addObject(){var e;const t=new i(100,60,256,256);t.rotateX(.5*-Math.PI);const s=new o({transparent:!0}),n=new l;let r=n.load("../texture/vc_cell.jpg");r.colorSpace=d,r.wrapT=u,r.wrapS=u,r.repeat.set(2,2);let I=n.load("../texture/vc_cell2.jpg");I.colorSpace=d,I.wrapT=u,I.wrapS=u,I.repeat.set(2,2);const S=c((([e,t])=>{const s=e.sub(m(.5)).mul(t).add(m(.5)).toVar();return s.x.lessThan(0).or(s.x.greaterThan(1)),s.y.lessThan(0).or(s.y.greaterThan(1)),h(1,0,0,0)})),V=c((([e,t])=>{const s=e,a=p(I,s);return b(s.x.lessThan(.8).and(s.x.greaterThan(.2)).and(s.y.lessThan(.8).and(s.y.greaterThan(.2))),(()=>{})),a}));g("#f223ff").toColor(),a(-.25),a(.2),a(7);const L=a(m(3,1)),N=a(2),O=a(.1),U=a(1.53),k=a(.2),B=a(.3),E=a(.15),F=a(.01),M=c((()=>{const e=x(T(),"testUV"),t=x(T(),"testUV2");S(e,2),V(t,2);const s=p(this.createCanvasTexture(r,I),T()),a=T().mul(10).toVar(),n=w(v(a,this.uTime.mul(.5)),1,0);h(n),y(s,h(0,0,0,1),n);const i=v(P.xz.add(5).mul(k).mul(2),this.uTime.mul(.5)),o=w(i,1,0).mul(.5).div(2).abs(),l=T().mul(2).toVar();y(o.div(1),l,.25);const d=p(r,T());return p(I,T().mul(m(2))),d})),W=c((([e])=>{const t=j(f(e.x.mul(L.x).add(this.uTime.mul(N))),f(e.z.mul(L.y).add(this.uTime.mul(N))),O).toVar();return z({start:C(1),end:U.add(1),condition:"<"},(({i:s})=>{const a=v(e.xz.add(5).mul(k).mul(s),this.uTime.mul(B)),n=w(a,1,0).mul(E).div(s).abs();t.subAssign(n)})),t})),X=W(P),G=P.add(v(0,X,0));s.colorNode=M();let K=P.add(v(F,0,0)),$=P.add(v(0,0,F.negate()));K=K.add(v(0,W(K),0)),$=$.add(v(0,W($),0));const q=K.sub(G).normalize(),D=$.sub(G).normalize(),H=q.cross(D);s.normalNode=_(H);const J=new A(t,s);J.rotateX(.5*Math.PI),null==(e=this.scene)||e.add(J)}createCanvasTexture(e,t){const s=1920,a=1080,n=document.createElement("canvas"),r=n.getContext("2d");n.width=s,n.height=a,null==r||r.drawImage(e.source.data,0,0,s,a),null==r||r.drawImage(t.source.data,384,216,1152,648);const i=new I(n);return i.needsUpdate=!0,i.colorSpace=d,i.wrapT=u,i.wrapS=u,i}initPostProcessing(){this.postProcessing=new S(this.renderer);const e=V(this.scene,this.camera).getTextureNode(),t=w(v(T().mul(m(20)),this.uTime.mul(.5)),.1,0);this.postProcessing.outputNode=e.add(e.sample(T().add(t)))}addLight(){this.light({type:"AmbientLight",x:30,y:30,z:30,intensity:1e3}),this.light({type:"PointLight",x:-30,y:30,z:0,intensity:1e3}),this.light({type:"AmbientLight",x:0,y:-30,z:-30,intensity:1e3})}};return N((()=>{L.load()})),O((()=>{L.destroy()})),(e,t)=>(E(),U(B,null,[t[0]||(t[0]=k("div",{id:"webgl"},null,-1)),t[1]||(t[1]=k("div",{class:"title-name"},"大量模型",-1))],64))}}),[["__scopeId","data-v-c0acd077"]]);export{M as default};

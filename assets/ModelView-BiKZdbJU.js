var w=Object.defineProperty;var M=(p,e,a)=>e in p?w(p,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):p[e]=a;var m=(p,e,a)=>M(p,typeof e!="symbol"?e+"":e,a);import{L as x,a as C,F as _,b as L,R as O,C as g,c as k,S as f,M as F,V as b,D as y,T as v,B as A,O as S,d as B,o as P,e as R,f as T}from"./index-BEz2KurK.js";class I extends x{constructor(e){super(e)}load(e,a,n,s){const r=this,l=this.path===""?C.extractUrlBase(e):this.path,i=new _(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,function(t){try{a(r.parse(t,l))}catch(o){s?s(o):console.error(o),r.manager.itemError(e)}},n,s)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,a){const n=e.split(`
`);let s={};const r=/\s+/,l={};for(let t=0;t<n.length;t++){let o=n[t];if(o=o.trim(),o.length===0||o.charAt(0)==="#")continue;const c=o.indexOf(" ");let h=c>=0?o.substring(0,c):o;h=h.toLowerCase();let d=c>=0?o.substring(c+1):"";if(d=d.trim(),h==="newmtl")s={name:d},l[d]=s;else if(h==="ka"||h==="kd"||h==="ks"||h==="ke"){const u=d.split(r,3);s[h]=[parseFloat(u[0]),parseFloat(u[1]),parseFloat(u[2])]}else s[h]=d}const i=new U(this.resourcePath||a,this.materialOptions);return i.setCrossOrigin(this.crossOrigin),i.setManager(this.manager),i.setMaterials(l),i}}class U{constructor(e="",a={}){this.baseUrl=e,this.options=a,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:L,this.wrap=this.options.wrap!==void 0?this.options.wrap:O}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;const a={};for(const n in e){const s=e[n],r={};a[n]=r;for(const l in s){let i=!0,t=s[l];const o=l.toLowerCase();switch(o){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(t=[t[0]/255,t[1]/255,t[2]/255]),this.options&&this.options.ignoreZeroRGBs&&t[0]===0&&t[1]===0&&t[2]===0&&(i=!1);break}i&&(r[o]=t)}}return a}preload(){for(const e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(const a in this.materialsInfo)this.materialsArray[e]=this.create(a),this.nameLookup[a]=e,e++;return this.materialsArray}create(e){return this.materials[e]===void 0&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){const a=this,n=this.materialsInfo[e],s={name:e,side:this.side};function r(i,t){return typeof t!="string"||t===""?"":/^https?:\/\//i.test(t)?t:i+t}function l(i,t){if(s[i])return;const o=a.getTextureParams(t,s),c=a.loadTexture(r(a.baseUrl,o.url));c.repeat.copy(o.scale),c.offset.copy(o.offset),c.wrapS=a.wrap,c.wrapT=a.wrap,(i==="map"||i==="emissiveMap")&&(c.colorSpace=f),s[i]=c}for(const i in n){const t=n[i];let o;if(t!=="")switch(i.toLowerCase()){case"kd":s.color=g.toWorkingColorSpace(new k().fromArray(t),f);break;case"ks":s.specular=g.toWorkingColorSpace(new k().fromArray(t),f);break;case"ke":s.emissive=g.toWorkingColorSpace(new k().fromArray(t),f);break;case"map_kd":l("map",t);break;case"map_ks":l("specularMap",t);break;case"map_ke":l("emissiveMap",t);break;case"norm":l("normalMap",t);break;case"map_bump":case"bump":l("bumpMap",t);break;case"map_d":l("alphaMap",t),s.transparent=!0;break;case"ns":s.shininess=parseFloat(t);break;case"d":o=parseFloat(t),o<1&&(s.opacity=o,s.transparent=!0);break;case"tr":o=parseFloat(t),this.options&&this.options.invertTrProperty&&(o=1-o),o>0&&(s.opacity=1-o,s.transparent=!0);break}}return this.materials[e]=new F(s),this.materials[e]}getTextureParams(e,a){const n={scale:new b(1,1),offset:new b(0,0)},s=e.split(/\s+/);let r;return r=s.indexOf("-bm"),r>=0&&(a.bumpScale=parseFloat(s[r+1]),s.splice(r,2)),r=s.indexOf("-s"),r>=0&&(n.scale.set(parseFloat(s[r+1]),parseFloat(s[r+2])),s.splice(r,4)),r=s.indexOf("-o"),r>=0&&(n.offset.set(parseFloat(s[r+1]),parseFloat(s[r+2])),s.splice(r,4)),n.url=s.join(" ").trim(),n}loadTexture(e,a,n,s,r){const l=this.manager!==void 0?this.manager:y;let i=l.getHandler(e);i===null&&(i=new v(l)),i.setCrossOrigin&&i.setCrossOrigin(this.crossOrigin);const t=i.load(e,n,s,r);return a!==void 0&&(t.mapping=a),t}}class W extends A{constructor(a){super();m(this,"model");m(this,"mixer");m(this,"actions");this.init(a),this.loadModel(),this.light(),this.animate(),this.plane()}loadModel(){new I().load("models/obj/743.obj/file.mtl",a=>{a.preload(),console.log(a),new S().setMaterials(a).load("models/obj/743.obj/file.obj",s=>{var r;console.log(s),s.scale.set(.05,.05,.05),s.position.set(0,1,0),(r=this.scene)==null||r.add(s)},s=>{console.log(s)},s=>{console.log(s)})})}animate(){var a,n,s,r;(a=this.stats)==null||a.begin(),(n=this.renderer)==null||n.render(this.scene,this.camera),(s=this.controls)==null||s.update(),requestAnimationFrame(this.animate.bind(this)),(r=this.stats)==null||r.end()}}const H={id:"container"},G=B({__name:"ModelView",setup(p){return P(()=>{new W("#container")}),(e,a)=>(R(),T("div",H))}});export{G as default};
